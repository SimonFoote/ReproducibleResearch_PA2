{
    "contents" : "---\ntitle: \"US Storm Analysis\"\noutput: html_document\nauthor: \"Simon Foote\"\n---\n\n#Synopsis\nIn this report, we will use data from the NOAA Storm Database, to answer the folowing questions:\n\n1. Across the United States, which types of events (as indicated in the EVTYPE variable) are most harmful with respect to population health?\n\n2. Across the United States, which types of events have the greatest economic consequences?\n\nFrom these data, we found that the Event Type of **Tornado**, was the most harmful to population health in the US and that the Event Type of **Flood** had the greatest economic consequences in the US.\n\n#Data Processing\n\n##Download Data file from Coursera\n```{r}\nURL <- \"https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2\"\nfilename <- \"repdata-data-StormData.csv.bz2\"\nif(!file.exists(filename))\n{\n    download.file(URL, filename)\n}\n```\n\n##Unzip and read in Data from csv file\n```{r}\ndata <- read.csv(bzfile(\"repdata-data-StormData.csv.bz2\"))\n```\nAfter reading in the data, we can see there are **902,297** observations and **37** variables.\n```{r}\ndim(data)\n```\n\n##Data Preparation\nWe will subset the data required for the analysis and then calculate the values of Damage for both Property and Crops\n```{r}\nsubsetData <- data[,c('EVTYPE','FATALITIES','INJURIES', 'PROPDMG', 'PROPDMGEXP', 'CROPDMG', 'CROPDMGEXP')]\n\n# Convert H, K, M, B units to calculate Property Damage \nsubsetData$PROPDMGVAL <- 0\nsubsetData[subsetData$PROPDMGEXP == \"H\", ]$PROPDMGVAL <- subsetData[subsetData$PROPDMGEXP == \"H\", ]$PROPDMG * 10^2\nsubsetData[subsetData$PROPDMGEXP == \"K\", ]$PROPDMGVAL <- subsetData[subsetData$PROPDMGEXP == \"K\", ]$PROPDMG * 10^3\nsubsetData[subsetData$PROPDMGEXP == \"M\", ]$PROPDMGVAL <- subsetData[subsetData$PROPDMGEXP == \"M\", ]$PROPDMG * 10^6\nsubsetData[subsetData$PROPDMGEXP == \"B\", ]$PROPDMGVAL <- subsetData[subsetData$PROPDMGEXP == \"B\", ]$PROPDMG * 10^9\n\n# Convert H, K, M, B units to calculate Crop Damage\nsubsetData$CROPDMGVAL <- 0\nsubsetData[subsetData$CROPDMGEXP == \"H\", ]$CROPDMGVAL <- subsetData[subsetData$CROPDMGEXP == \"H\", ]$CROPDMG * 10^2\nsubsetData[subsetData$CROPDMGEXP == \"K\", ]$CROPDMGVAL <- subsetData[subsetData$CROPDMGEXP == \"K\", ]$CROPDMG * 10^3\nsubsetData[subsetData$CROPDMGEXP == \"M\", ]$CROPDMGVAL <- subsetData[subsetData$CROPDMGEXP == \"M\", ]$CROPDMG * 10^6\nsubsetData[subsetData$CROPDMGEXP == \"B\", ]$CROPDMGVAL <- subsetData[subsetData$CROPDMGEXP == \"B\", ]$CROPDMG * 10^9\n```\n\n#Results\n##Question 1\nTo answer the Question:\n**Across the United States, which types of events (as indicated in the EVTYPE variable) are most harmful with respect to population health?**\n\nWe will first aggregate the Fatalites by Event Type and plot the Top 10 counts by Event Type.\n\n```{r}\nfatalities <- aggregate(FATALITIES ~ EVTYPE, data=subsetData, sum)\nfatalities <- fatalities[order(-fatalities$FATALITIES), ][1:10, ]\n\nbarplot(fatalities$FATALITIES, names = fatalities$EVTYPE, ylab=\"Fatalities\", main=\"Total No. of Fatalities by Top 10 Event Types\", las=2, cex.axis=0.5, cex.names=0.5)\n```\n\nThen we will aggregate the Injuries by Event type and plot the Top 10 counts by Event Type.\n\n```{r}\ninjuries <- aggregate(INJURIES ~ EVTYPE, data=subsetData, sum)\ninjuries <- injuries[order(-injuries$INJURIES), ][1:10, ]\n\nbarplot(injuries$INJURIES, names = injuries$EVTYPE, ylab=\"Injuries\", main=\"Total No. of Injuries by Top 10 Event Types\", las=2, cex.axis=0.5, cex.names=0.5)\n```\n\n###Conclusion\nIt is clear in the plots above, in both cases of Fatalities and Injuries, that **Tornado** type Events are the most harmful to population health in the US.\n\n##Question 2\nTo answer the Question:\n**Across the United States, which types of events have the greatest economic consequences?**\n\nWe will agregate Value of damage for both Property and Crops, by Event type and plot the results for the Top 10 Events.\n\n```{r}\ndamages <- aggregate(PROPDMGVAL + CROPDMGVAL ~ EVTYPE, data=subsetData, sum)\nnames(damages) = c(\"EVTYPE\", \"TOTALDAMAGE\")\ndamages <- damages[order(-damages$TOTALDAMAGE), ][1:10, ]\n\nbarplot(damages$TOTALDAMAGE, names = damages$EVTYPE, ylab=\"Cost of Damage\", main=\"Total Cost of Damage by Top 10 Event Types\", las=2, cex.axis=0.5, cex.names=0.5)\n```\n\n###Conclusion\nThe above plot shows that the Event of **Flood**, has the greatest economic consequences in the US.",
    "created" : 1448194282056.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2858750354",
    "id" : "DC59D6CF",
    "lastKnownWriteTime" : 1448202392,
    "path" : "~/ReproducibleResearch_PA2/RR_PA2.Rmd",
    "project_path" : "RR_PA2.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_markdown"
}